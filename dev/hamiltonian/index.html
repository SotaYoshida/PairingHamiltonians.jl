<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Hamiltonian · PairingHamiltonians.jl</title><meta name="title" content="Hamiltonian · PairingHamiltonians.jl"/><meta property="og:title" content="Hamiltonian · PairingHamiltonians.jl"/><meta property="twitter:title" content="Hamiltonian · PairingHamiltonians.jl"/><meta name="description" content="Documentation for PairingHamiltonians.jl."/><meta property="og:description" content="Documentation for PairingHamiltonians.jl."/><meta property="twitter:description" content="Documentation for PairingHamiltonians.jl."/><meta property="og:url" content="https://SotaYoshida.github.io/PairingHamiltonians.jl/hamiltonian/"/><meta property="twitter:url" content="https://SotaYoshida.github.io/PairingHamiltonians.jl/hamiltonian/"/><link rel="canonical" href="https://SotaYoshida.github.io/PairingHamiltonians.jl/hamiltonian/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="PairingHamiltonians.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">PairingHamiltonians.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../howtostart/">How to start</a></li><li><a class="tocitem" href="../contributing/">Contributing to PairingHamiltonians</a></li><li class="is-active"><a class="tocitem" href>Hamiltonian</a></li><li><span class="tocitem">Many-body methods</span><ul><li><a class="tocitem" href="../fullCI/">Full CI</a></li><li><a class="tocitem" href="../hartreefock/">Hartree-Fock</a></li><li><a class="tocitem" href="../mbpt/">MBPT</a></li><li><a class="tocitem" href="../bcs/">BCS</a></li><li><a class="tocitem" href="../coupledcluster/">Coupled Cluster</a></li><li><a class="tocitem" href="../imsrg/">IM-SRG</a></li><li><a class="tocitem" href="../eigenvectorcontinuation/">Eigenvector Continuation</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Hamiltonian</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Hamiltonian</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/SotaYoshida/PairingHamiltonians.jl/blob/main/docs/src/hamiltonian.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Hamiltonian"><a class="docs-heading-anchor" href="#Hamiltonian">Hamiltonian</a><a id="Hamiltonian-1"></a><a class="docs-heading-anchor-permalink" href="#Hamiltonian" title="Permalink"></a></h1><p>Functions for constructing paring Hamiltonian and some utilities for handling it.</p><p class="math-container">\[H_\mathrm{pair} = \sum_{i=1}^{N} \epsilon_i a_i^\dagger a_i - \frac{g}{4} \sum_{ij} a_i^\dagger a^\dagger_{\bar{i}} a_{\bar{j}} a_j\]</p><p>One can use the following methods to solve the pairing Hamiltonian with the package:</p><ul><li>&quot;Full-CI&quot;: Full-CI/Exact diagonalization</li><li>&quot;Full-CI(2-fold)&quot;: Full-CI/Exact diagonalization assuming that particles are paired</li><li>&quot;HF&quot;: Hartree-Fock (nothing but naive filling due to the pairing Hamiltonian)    Under this method, MBPT calculation with the HF reference state are carried out.</li><li>&quot;BCS&quot;: Bardeen-Cooper-Schrieffer</li><li>&quot;CCD&quot;: Coupled Cluster, especially CCD</li><li>&quot;IMSRG(2)&quot;: In-Medium Similarity Renormalization Group, especially IM-SRG(2)</li></ul><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PairingHamiltonians.PairingHamiltonian-Tuple{}" href="#PairingHamiltonians.PairingHamiltonian-Tuple{}"><code>PairingHamiltonians.PairingHamiltonian</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">PairingHamiltonian(;Norb_in::Int=8, Nocc_in::Int=4, gval::Float64=0.33, delta_eps::Float64=1.0,
                    debug_mode::Int=0, solver::String=&quot;FCI(2-fold)&quot;, save_Exact_wf::Bool=false, to_in=nothing)</code></pre><p>Main function to evaluate the ground state energy of the pairing Hamiltonian.</p><p><strong>Optional arguments with default values</strong></p><ul><li><code>Norb_in::Int=8</code>: number of orbitals</li><li><code>Nocc_in::Int=4</code>: number of occupied states</li><li><code>gval::Float64=0.33</code>: pairing strength</li><li><code>delta_eps::Float64=1.0</code>: energy difference between orbitals</li><li><code>debug_mode::Int=0</code>: specify the debug mode</li><li><code>solver::String(&quot;FCI(2-fold)&quot;)</code>: method to solve the Hamiltonian. This can be one of &quot;Full-CI&quot;, &quot;Full-CI(2-fold)&quot;, &quot;HF&quot;, &quot;BCS&quot;, &quot;CCD&quot;, &quot;IMSRG(2)&quot;. If &quot;HF&quot; is chosen, PT2/PT3 energies are also calculated.</li><li><code>save_Exact_wf::Bool(false)</code>: save the full-CI wave functions as HDF5 files, which can be used for e.g. analysis of the wave functions and constructing surrogate models like eigenvector continuation.</li><li><code>to</code>: either nothing or TimerOutput object defined in a user script.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SotaYoshida/PairingHamiltonians.jl/blob/89ff568e558350ca20e0545d8e7bd0cc6b63daff/src/hamiltonian.jl#L268-L283">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PairingHamiltonians.bitstr2int-Tuple{String}" href="#PairingHamiltonians.bitstr2int-Tuple{String}"><code>PairingHamiltonians.bitstr2int</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">bitstr2int(bitstr::String)::Int</code></pre><p>Convert a bitstring representation (e.g., &quot;00110&quot;) to an integer (e.g., 6).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SotaYoshida/PairingHamiltonians.jl/blob/89ff568e558350ca20e0545d8e7bd0cc6b63daff/src/hamiltonian.jl#L50-L54">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PairingHamiltonians.check_connectivity-NTuple{5, Int64}" href="#PairingHamiltonians.check_connectivity-NTuple{5, Int64}"><code>PairingHamiltonians.check_connectivity</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">check_connectivity(psi_l::Int, psi_r::Int, p::Int, q::Int, Nq::Int)::Bool</code></pre><p>Check if the configurations (in bit representation) are connected by the Hamiltonian.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SotaYoshida/PairingHamiltonians.jl/blob/89ff568e558350ca20e0545d8e7bd0cc6b63daff/src/hamiltonian.jl#L70-L74">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PairingHamiltonians.eval_Hamil-Tuple{String, Vector{Int64}, Vector{Float64}, Float64, Int64, Bool}" href="#PairingHamiltonians.eval_Hamil-Tuple{String, Vector{Int64}, Vector{Float64}, Float64, Int64, Bool}"><code>PairingHamiltonians.eval_Hamil</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">eval_Hamil(method::String, basis::Vector{Int}, eps::Vector{Float64}, g::Float64, Nq::Int, degenerate::Bool; debug_mode::Int=0, sparce_rep::Bool=false)::Tuple{Matrix{Float64}, Matrix{Float64}, Union{Matrix{Float64}, Dict{UInt64, Float64}}}</code></pre><p>Function to evaluate the Hamiltonian matrix elements. Once the number of orbitals and the number of occupied states are given, one can prepare the Hamiltonian matrix elements in the full matrix representation or sparse representation. For larger systems, sparse representation using <code>Dict{UInt64, Float64}</code> is used instead of storing the full matrix. The keys of the dictionary correspond to the integer representation of many-body configurations.</p><p>Note that <code>&quot;1&quot;</code> and <code>&#39;1&#39;</code> are different in Julia. The former is a string, while the latter is a character.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SotaYoshida/PairingHamiltonians.jl/blob/89ff568e558350ca20e0545d8e7bd0cc6b63daff/src/hamiltonian.jl#L111-L121">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PairingHamiltonians.hash_key2-Tuple{Any, Any}" href="#PairingHamiltonians.hash_key2-Tuple{Any, Any}"><code>PairingHamiltonians.hash_key2</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">hash_key2(i::Int, j::Int)::UInt64</code></pre><p>Hash the pair of indices to a key.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SotaYoshida/PairingHamiltonians.jl/blob/89ff568e558350ca20e0545d8e7bd0cc6b63daff/src/hamiltonian.jl#L101-L105">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PairingHamiltonians.int2bitstr-Tuple{Any, Any}" href="#PairingHamiltonians.int2bitstr-Tuple{Any, Any}"><code>PairingHamiltonians.int2bitstr</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">int2bitstr(x::Int, N::Int)::String</code></pre><p>Convert an integer to a bitstring of length <code>N</code>. Similar thing can be done with string function in Julia, but this is more proper way for &quot;0&quot; padding. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SotaYoshida/PairingHamiltonians.jl/blob/89ff568e558350ca20e0545d8e7bd0cc6b63daff/src/hamiltonian.jl#L60-L65">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PairingHamiltonians.prepare_basis-Tuple{Any, Any}" href="#PairingHamiltonians.prepare_basis-Tuple{Any, Any}"><code>PairingHamiltonians.prepare_basis</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">prepare_basis(N::Int, n::Int)::Vector{Int}</code></pre><p>Create a list of configurations where n out of N are occupied.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SotaYoshida/PairingHamiltonians.jl/blob/89ff568e558350ca20e0545d8e7bd0cc6b63daff/src/hamiltonian.jl#L34-L38">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PairingHamiltonians.unhash_key2-Tuple{UInt64}" href="#PairingHamiltonians.unhash_key2-Tuple{UInt64}"><code>PairingHamiltonians.unhash_key2</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">unhash_key2(key::UInt64)::Tuple{Int, Int}</code></pre><p>Unhash the key to the pair of indices.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SotaYoshida/PairingHamiltonians.jl/blob/89ff568e558350ca20e0545d8e7bd0cc6b63daff/src/hamiltonian.jl#L90-L94">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../contributing/">« Contributing to PairingHamiltonians</a><a class="docs-footer-nextpage" href="../fullCI/">Full CI »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.1 on <span class="colophon-date" title="Monday 17 February 2025 12:57">Monday 17 February 2025</span>. Using Julia version 1.11.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
